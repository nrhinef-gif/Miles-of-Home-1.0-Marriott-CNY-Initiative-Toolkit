<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>6D Radar Scorecard (Interactive)</title>
  <style>
    :root{
      /* Premium warm-neutral palette */
      --bg: #fbfaf7;
      --card: rgba(255,255,255,.72);
      --ink: #1f1a16;
      --muted: rgba(31,26,22,.60);
      --grid: rgba(31,26,22,.12);
      --grid2: rgba(31,26,22,.06);
      --accent: #7a4e2d;      /* espresso */
      --accent2:#c28a5a;      /* caramel */
      --ok: #2f6b4f;
      --warn:#a86b1d;
      --bad: #8a2c2c;
      --shadow: 0 18px 50px rgba(20,16,12,.10);
      --radius: 22px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:
        radial-gradient(1200px 800px at 12% 10%, rgba(194,138,90,.12), transparent 60%),
        radial-gradient(1000px 700px at 85% 15%, rgba(122,78,45,.10), transparent 55%),
        radial-gradient(900px 700px at 50% 95%, rgba(31,26,22,.08), transparent 55%),
        var(--bg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      padding:28px;
    }

    .wrap{
      width:min(1220px, 96vw);
      display:grid;
      grid-template-columns: 1.85fr 0.85fr;
      gap:22px;
      align-items:stretch;
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.82), rgba(255,255,255,.62));
      box-shadow: var(--shadow);
      border: 1px solid rgba(31,26,22,.08);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(620px 320px at 20% 10%, rgba(194,138,90,.18), transparent 55%),
        radial-gradient(760px 380px at 90% 0%, rgba(122,78,45,.14), transparent 60%);
      pointer-events:none;
      opacity:.62;
    }

    .left{
      padding:24px 24px 18px;
      display:flex;
      flex-direction:column;
      gap:10px;
      z-index:1;
      position:relative;
    }

    .kicker{
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(31,26,22,.55);
    }
    h1{
      margin:0;
      font-size:28px;
      line-height:1.15;
      letter-spacing:-0.02em;
    }
    .sub{
      margin:0;
      font-size:14px;
      color: var(--muted);
      line-height:1.55;
      max-width:64ch;
    }

    .chartWrap{
      margin-top:3px;
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius: calc(var(--radius) - 6px);
      border:1px solid rgba(31,26,22,.08);
      background: rgba(255,255,255,.55);
      overflow:hidden;
      position:relative;
    }
    svg{ width:100%; height:100%; display:block; }

    .scoreBar{
      margin-top:3px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      padding:12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(31,26,22,.10);
      background: rgba(255,255,255,.55);
    }
    .scoreBar .big{
      display:flex; flex-direction:column; gap:2px;
    }
    .scoreBar .big b{
      font-size:12px; letter-spacing:.14em; text-transform:uppercase; color:rgba(31,26,22,.55);
    }
    .scoreBar .big span{
      font-size:28px; font-weight:800; letter-spacing:-0.02em;
    }
    .badge{
      padding:8px 12px;
      border-radius:999px;
      font-size:12px;
      font-weight:700;
      border:1px solid rgba(31,26,22,.10);
      background: rgba(255,255,255,.55);
      color: rgba(31,26,22,.75);
      white-space:nowrap;
    }
    .badge.good{ color: var(--ok); border-color: rgba(47,107,79,.22); background: rgba(47,107,79,.08); }
    .badge.mid{ color: var(--warn); border-color: rgba(168,107,29,.22); background: rgba(168,107,29,.08); }
    .badge.low{ color: var(--bad); border-color: rgba(138,44,44,.22); background: rgba(138,44,44,.08); }

    .right{
      padding:18px 18px 16px;
      z-index:1;
      position:relative;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .panelTitle{
      display:flex;
      justify-content:space-between;
      align-items:baseline;
      gap:10px;
      padding:6px 6px 0;
    }
    .panelTitle b{ font-size:13px; letter-spacing:.12em; text-transform:uppercase; color:rgba(31,26,22,.55); }
    .panelTitle span{ font-size:12px; color:var(--muted); }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border-radius: 16px;
      border:1px solid rgba(31,26,22,.10);
      background: rgba(255,255,255,.55);
    }
    th, td{
      padding:10px 12px;
      font-size:12px;
      border-bottom:1px solid rgba(31,26,22,.08);
    }
    th{
      text-align:left;
      letter-spacing:.08em;
      text-transform:uppercase;
      color: rgba(31,26,22,.55);
      font-weight:800;
      background: rgba(255,255,255,.45);
    }
    tr:last-child td{ border-bottom:none; }
    .dim{
      font-weight:700;
      color: rgba(31,26,22,.78);
      line-height:1.25;
    }
    .dim small{
      display:block;
      font-weight:600;
      color: rgba(31,26,22,.48);
      margin-top:2px;
    }

    input[type="number"]{
      width:100%;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(31,26,22,.14);
      background: rgba(255,255,255,.70);
      color: var(--ink);
      outline:none;
      font-weight:700;
    }
    input[type="number"]:focus{
      border-color: rgba(122,78,45,.55);
      box-shadow: 0 0 0 4px rgba(194,138,90,.18);
    }

    .btnRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      padding:4px 2px 0;
    }
    button{
      cursor:pointer;
      border-radius: 999px;
      border:1px solid rgba(31,26,22,.12);
      background: rgba(255,255,255,.60);
      padding:10px 12px;
      font-size:12px;
      font-weight:750;
      color: rgba(31,26,22,.78);
      transition: transform .05s ease, box-shadow .2s ease, border-color .2s ease;
    }
    button:hover{
      border-color: rgba(122,78,45,.35);
      box-shadow: 0 10px 24px rgba(20,16,12,.10);
      transform: translateY(-1px);
    }

    .help{
      margin-top:6px;
      border-radius: 16px;
      border:1px solid rgba(31,26,22,.10);
      background: rgba(255,255,255,.50);
      padding:12px 12px;
      font-size:12px;
      color: rgba(31,26,22,.62);
      line-height:1.55;
    }
    .help b{ color: rgba(31,26,22,.80); }
    code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:11px;
      background: rgba(31,26,22,.06);
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(31,26,22,.08);
    }

    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
      h1{ font-size:24px; }
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- LEFT: chart + score -->
    <section class="card left">
      <div class="kicker">Hotel Selection Scorecard</div>
      <h1>6-Dimension Radar Scorecard</h1>
      <p class="sub">
        Enter each dimension score (0–100) and weight. The radar updates instantly and the
        overall score is calculated as a weighted average (0–100).
      </p>

      <div class="chartWrap">
        <svg id="radar" viewBox="0 0 600 600" aria-label="6-dimension radar chart" role="img">
          <defs>
            <filter id="softShadow" x="-30%" y="-30%" width="160%" height="160%">
              <feDropShadow dx="0" dy="10" stdDeviation="10" flood-color="rgba(20,16,12,0.18)"/>
            </filter>

            <linearGradient id="fillGrad" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%"  stop-color="rgba(194,138,90,0.45)"/>
              <stop offset="100%" stop-color="rgba(122,78,45,0.18)"/>
            </linearGradient>

            <linearGradient id="strokeGrad" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="rgba(194,138,90,0.95)"/>
              <stop offset="100%" stop-color="rgba(122,78,45,0.95)"/>
            </linearGradient>
          </defs>
          <!-- layers injected by JS -->
        </svg>
      </div>

      <div class="scoreBar">
        <div class="big">
          <b>Overall Fit Score</b>
          <span id="totalScore">—</span>
        </div>
        <div id="tierBadge" class="badge">—</div>
      </div>

      <div class="help">
        <b>Formula:</b> <code>Total = Σ(scoreᵢ × weightᵢ) / Σ(weightᵢ)</code><br/>
        Scores are clamped to 0–100. Weights can be any numbers (not necessarily 100); use “Normalize Weights” if needed.
      </div>
    </section>

    <!-- RIGHT: inputs -->
    <section class="card right">
      <div class="panelTitle">
        <b>Input Scores & Weights</b>
        <span>0–100 scores · weights flexible</span>
      </div>

      <table id="inputTable" aria-label="Radar inputs table">
        <thead>
          <tr>
            <th style="width:52%">Dimension</th>
            <th style="width:24%">Score (0–100)</th>
            <th style="width:24%">Weight</th>
          </tr>
        </thead>
        <tbody>
          <!-- rows injected by JS -->
        </tbody>
      </table>

      <div class="btnRow">
        <button id="btnSample" type="button">Reset Sample</button>
        <button id="btnNormalize" type="button">Normalize Weights</button>
        <button id="btnExport" type="button">Export SVG</button>
      </div>

      <div class="help">
        <b>Usage (for Slide 14):</b><br/>
        1) Fill 6 scores based on the hotel’s data/interviews (0–100).<br/>
        2) Adjust weights to reflect priority (e.g., Owner Funding Intent higher).<br/>
        3) Read <b>Overall Fit Score</b> and compare hotel “shapes”.<br/>
        4) Put definitions/data sources in Notes or Appendix (A2).<br/><br/>
        <b>Tip:</b> Keep the radar on-slide for “shape comparison”. Use Appendix for the full scorecard rubric & weights.
      </div>
    </section>
  </div>

<script>
/** ============ CONFIG (edit labels here if needed) ============ **/
const model = {
  labels: [
    { title: "Non-local Staff Ratio", subtitle: "workforce mix" },
    { title: "Post-CNY Attrition", subtitle: "historical data" },
    { title: "Scheduling Flexibility", subtitle: "ops feasibility" },
    { title: "Comms Capability", subtitle: "content readiness" },
    { title: "Owner Funding Intent", subtitle: "buy-in level" },
    { title: "Brand Representation Need", subtitle: "portfolio coverage" }
  ],
  // Default sample (you can replace per hotel)
  scores: [72, 58, 81, 66, 74, 60],   // 0..100
  weights:[18, 18, 16, 14, 22, 12],   // any positive numbers
  rings: 6,
  min: 0,
  max: 100
};

/** ============ RADAR SVG RENDERER ============ **/
const svg = document.getElementById("radar");
const W = 600, H = 600;
const cx = W/2, cy = H/2;
const padding = 168;
const R = Math.min(W, H)/2 - padding;
const axes = model.labels.length;
const angle0 = -Math.PI/2;

function polarToXY(r, a){ return [cx + r*Math.cos(a), cy + r*Math.sin(a)]; }

function el(name, attrs = {}, parent = svg){
  const node = document.createElementNS("http://www.w3.org/2000/svg", name);
  for (const [k,v] of Object.entries(attrs)) node.setAttribute(k, v);
  parent.appendChild(node);
  return node;
}

function clamp(n, lo, hi){ return Math.max(lo, Math.min(hi, n)); }

function buildRadar(){
  // remove existing g layers (keep defs)
  [...svg.querySelectorAll(":scope > g")].forEach(n => n.remove());
  const g = el("g", {});

  // subtle background
  el("circle", { cx, cy, r: R + 24, fill: "rgba(255,255,255,0.45)" }, g);

  // grid rings
  for (let i=1; i<=model.rings; i++){
    const rr = R * (i/model.rings);
    el("circle", {
      cx, cy, r: rr,
      fill: "none",
      stroke: (i === model.rings) ? "rgba(31,26,22,0.12)" : "rgba(31,26,22,0.08)",
      "stroke-width": (i === model.rings) ? "1.4" : "1"
    }, g);
  }

  // axis lines + labels
  for (let k=0; k<axes; k++){
    const a = angle0 + k*(2*Math.PI/axes);
    const [x,y] = polarToXY(R, a);

    el("line", {
      x1: cx, y1: cy, x2: x, y2: y,
      stroke: "rgba(31,26,22,0.12)",
      "stroke-width": "1"
    }, g);

    const [lx, ly] = polarToXY(R + 42, a);
    const anchor = (Math.cos(a) > 0.25) ? "start" : (Math.cos(a) < -0.25) ? "end" : "middle";

    const text = el("text", {
      x: lx, y: ly,
      "text-anchor": anchor,
      "dominant-baseline": "middle",
      fill: "rgba(31,26,22,0.82)",
      "font-size": "10",
      "font-weight": "650",
      "letter-spacing": "0.01em"
    }, g);

    el("tspan", { x: lx, dy: "0", fill:"rgba(31,26,22,0.82)", "font-weight":"700" }, text)
      .textContent = model.labels[k].title;

    el("tspan", { x: lx, dy: "1.2em", fill:"rgba(31,26,22,0.55)", "font-weight":"600" }, text)
      .textContent = model.labels[k].subtitle;
  }

  // polygon points
  const pts = [];
  for (let k=0; k<axes; k++){
    const a = angle0 + k*(2*Math.PI/axes);
    const v = clamp(Number(model.scores[k] ?? 0), model.min, model.max);
    const rr = R * ((v - model.min) / (model.max - model.min));
    pts.push(polarToXY(rr, a));
  }
  const pointsStr = pts.map(p => p.join(",")).join(" ");

  // polygon fill + stroke
  el("polygon", {
    points: pointsStr,
    fill: "url(#fillGrad)",
    stroke: "url(#strokeGrad)",
    "stroke-width": "3",
    filter: "url(#softShadow)",
    "stroke-linejoin": "round"
  }, g);

  // vertex dots
  pts.forEach(([x,y], k) => {
    const dot = el("circle", {
      cx:x, cy:y, r:"5.2",
      fill:"rgba(255,255,255,0.92)",
      stroke:"rgba(122,78,45,0.92)",
      "stroke-width":"2"
    }, g);
    const title = document.createElementNS("http://www.w3.org/2000/svg","title");
    title.textContent = `${model.labels[k].title}: ${model.scores[k]} (w=${model.weights[k]})`;
    dot.appendChild(title);
  });

  // center badge (text injected via DOM outside)
}

/** ============ SCORING ============ **/
const totalScoreEl = document.getElementById("totalScore");
const tierBadgeEl = document.getElementById("tierBadge");

function computeTotal(){
  const scores = model.scores.map(s => clamp(Number(s || 0), 0, 100));
  const weights = model.weights.map(w => Math.max(0, Number(w || 0)));
  const wsum = weights.reduce((a,b)=>a+b, 0);

  let total = 0;
  if (wsum > 0){
    total = scores.reduce((acc, s, i) => acc + s * weights[i], 0) / wsum;
  } else {
    // fallback: simple average if all weights 0
    total = scores.reduce((a,b)=>a+b, 0) / scores.length;
  }
  return Math.round(total * 10) / 10; // one decimal
}

function tierFromScore(x){
  // You can adjust thresholds to match your internal policy.
  if (x >= 80) return { text:"Strong Pilot Fit", cls:"good" };
  if (x >= 65) return { text:"Good Fit (Review)", cls:"mid" };
  return { text:"Conditional Fit", cls:"low" };
}

function refresh(){
  // sanitize
  model.scores = model.scores.map(v => clamp(Number(v || 0), 0, 100));
  model.weights = model.weights.map(v => Math.max(0, Number(v || 0)));

  const total = computeTotal();
  totalScoreEl.textContent = String(total);

  const tier = tierFromScore(total);
  tierBadgeEl.textContent = tier.text;
  tierBadgeEl.className = `badge ${tier.cls}`;

  buildRadar();
}

/** ============ INPUT UI ============ **/
const tbody = document.querySelector("#inputTable tbody");

function makeRow(i){
  const tr = document.createElement("tr");

  const tdDim = document.createElement("td");
  tdDim.className = "dim";
  tdDim.innerHTML = `${model.labels[i].title}<small>${model.labels[i].subtitle}</small>`;

  const tdScore = document.createElement("td");
  const scoreInput = document.createElement("input");
  scoreInput.type = "number";
  scoreInput.min = "0";
  scoreInput.max = "100";
  scoreInput.step = "1";
  scoreInput.value = model.scores[i];
  scoreInput.addEventListener("input", () => {
    model.scores[i] = scoreInput.value;
    refresh();
  });
  tdScore.appendChild(scoreInput);

  const tdWeight = document.createElement("td");
  const weightInput = document.createElement("input");
  weightInput.type = "number";
  weightInput.min = "0";
  weightInput.step = "1";
  weightInput.value = model.weights[i];
  weightInput.addEventListener("input", () => {
    model.weights[i] = weightInput.value;
    refresh();
  });
  tdWeight.appendChild(weightInput);

  tr.appendChild(tdDim);
  tr.appendChild(tdScore);
  tr.appendChild(tdWeight);
  return tr;
}

function buildTable(){
  tbody.innerHTML = "";
  for (let i=0; i<axes; i++) tbody.appendChild(makeRow(i));
}

buildTable();
refresh();

/** ============ BUTTONS ============ **/
document.getElementById("btnSample").addEventListener("click", () => {
  model.scores = [72,58,81,66,74,60];
  model.weights = [18,18,16,14,22,12];
  buildTable();
  refresh();
});

document.getElementById("btnNormalize").addEventListener("click", () => {
  const w = model.weights.map(x => Math.max(0, Number(x || 0)));
  const sum = w.reduce((a,b)=>a+b, 0);
  if (sum <= 0) return;
  // normalize to 100 with one decimal
  model.weights = w.map(x => Math.round((x / sum) * 1000) / 10);
  buildTable();
  refresh();
});

document.getElementById("btnExport").addEventListener("click", () => {
  // Export the SVG markup as a file (for PPT: insert as vector)
  const serializer = new XMLSerializer();
  const svgClone = svg.cloneNode(true);

  // Ensure inline size for export friendliness
  svgClone.setAttribute("xmlns", "http://www.w3.org/2000/svg");
  svgClone.setAttribute("width", "1200");
  svgClone.setAttribute("height", "1200");

  const source = serializer.serializeToString(svgClone);
  const blob = new Blob([source], { type: "image/svg+xml;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "Slide14_RadarScorecard.svg";
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});
</script>
</body>
</html>
